server {
  listen 80;
  server_name matrix.synapse.localhost;

  location ~ ^(/_matrix|/_synapse/client) {
    proxy_pass http://synapse:8008;
    proxy_set_header Host matrix.synapse.localhost;
  }

  location /favicon.ico {
    proxy_pass https://alertrix.net/favicon.ico;
  }
}

server {
  listen 80;
  listen 8448;
  server_name synapse.localhost;

  location /.well-known/matrix/client {
    default_type application/json;
    return 200 '{"m.homeserver": {"base_url": "http://matrix.synapse.localhost"}}';
  }
  location /.well-known/matrix/server {
    default_type application/json;
    return 200 '{"m.server": "http://matrix.synapse.localhost:80"}';
  }

  location /favicon.ico {
    proxy_pass https://alertrix.net/favicon.ico;
  }
}
